# 三云零售分析系统

一个基于Python + Oracle数据库 + Vue.js的零售数据分析系统，专为零售业务数据分析而设计。

## 项目结构

```
Code4Bos/
├── sanyun-back-end/          # Flask后端API服务
├── sanyun-retail-vue/        # Vue前端应用
├── database_structure/       # 数据库结构分析
├── db_helper.py             # 数据库操作工具
└── requirements.txt         # Python依赖
```

## 核心功能

### 销售分析页面
- **销售概览**: 日销售额、月销售额统计与增长率分析
- **店铺排行**: 按销售额排序的店铺排行榜
- **销售趋势**: 基于选择日期的销售趋势数据分析
- **核心指标分析**: 8项关键业务指标的实时监控
- **会员分析**: 新增会员、活跃会员及会员销售占比分析

### 核心指标分析功能
系统提供以下8项关键业务指标的实时分析：

1. **销售额**: 当期总销售额，含环比和同比增长率
2. **折扣率**: 平均折扣率及其变化趋势
3. **客单价**: 平均订单金额及其变化趋势
4. **销售附加**: 商品附加值比例分析
5. **活跃店铺**: 有交易的店铺数量统计
6. **新客占比**: 新开卡会员在总客户中的占比
7. **会员回店**: 重复购买会员的比例分析
8. **连带率**: 每笔订单的商品连带销售率

每项指标都提供：
- 当期数值
- 环比变化率（与上期对比）
- 同比变化率（与去年同期对比）

### 数据分析模式
- **日数据分析**: 分析选定日期的单日数据
- **月数据分析**: 分析选定月份的整月数据

## 最近功能更新

### 2024年12月 - 核心指标分析功能实现
**新增功能**:
- 实现了8项核心业务指标的计算和显示
- 添加了基于真实数据库数据的指标计算逻辑
- 支持日数据和月数据两种分析模式
- 实现了环比和同比增长率的动态计算
- 优化了会员分析模块，支持日期选择

**技术改进**:
- 修改`get_sales_metrics()`方法支持日期和分析类型参数
- 修改`get_member_analysis()`方法支持动态日期分析
- 更新相关API接口支持参数传递
- 前端实现指标数据的实时更新

**数据指标**:
- 销售额、折扣率、客单价、销售附加
- 活跃店铺、新客占比、会员回店、连带率
- 新增会员、活跃会员、会员销售占比

### 2024年12月 - 销售分析页面优化
**修复问题**:
- 修复了日期选择器无法正常显示的问题
- 移除了年数据分析选项，精简为日/月分析
- 删除了调试按钮和刷新按钮
- 修复了销售趋势显示随机数值的问题

**功能改进**:
- 实现了基于用户选择日期的真实数据读取
- 优化了Vant UI组件的使用方式
- 改善了用户交互体验

### 2024年12月 - 后端API与数据库集成
**核心实现**:
- 建立了Flask后端API服务框架
- 实现了Oracle数据库连接和查询
- 创建了销售、店铺、会员等核心数据服务
- 建立了前后端数据交互机制

**API接口**:
- `/api/sales/overview` - 销售概览数据
- `/api/sales/stores` - 店铺排行数据  
- `/api/sales/metrics` - 销售指标数据
- `/api/sales/trend` - 销售趋势数据
- `/api/members/analysis` - 会员分析数据

## 数据库配置

```python
DB_CONFIG = {
    'user': 'bosnds3',
    'password': 'abc123', 
    'dsn': '49.235.20.50:8853/orcl'
}
```

## 核心表结构

- **m_retail**: 零售交易表（主要数据源）
- **c_store**: 店铺信息表
- **c_vips**: 会员信息表

## 启动说明

### 后端启动
```bash
cd sanyun-back-end
python app.py
```

### 前端启动  
```bash
cd sanyun-retail-vue
npm install
npm run dev
```

## 技术栈

- **后端**: Python + Flask + cx-Oracle
- **前端**: Vue 3 + Vant UI + Axios
- **数据库**: Oracle 11g
- **部署**: 本地开发环境

## 开发指南

### 数据查询优化
- 所有查询都排除仓库类店铺
- 使用数字格式日期(YYYYMMDD)进行查询
- 实现了安全的除法计算和百分比计算
- 添加了错误处理和日志记录

### 前端开发规范
- 使用组合式API (Composition API)
- 统一的错误提示和加载状态管理
- 响应式数据绑定和实时更新
- 移动端适配的UI设计

项目持续更新中，欢迎提出建议和改进意见。 # qin
